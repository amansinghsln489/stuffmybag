{% comment %}
  Wishlist Page Template
{% endcomment %}

<h1>My Wishlist</h1>
<p id="empty-wishlist">Your wishlist is empty.</p>
<ul id="wishlist-items"></ul>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    let wishlist = JSON.parse(localStorage.getItem("wishlist")) || [];
    let wishlistContainer = document.getElementById("wishlist-items");
    let emptyMessage = document.getElementById("empty-wishlist");

    if (wishlist.length === 0) {
      emptyMessage.style.display = "block";
      wishlistContainer.style.display = "none";
    } else {
      emptyMessage.style.display = "none";
      wishlistContainer.style.display = "block";

      wishlist.forEach(productId => {
        fetch(`/products/${productId}.json`)
          .then(response => response.json())
          .then(data => {
            let product = data.product;
            let li = document.createElement("li");
            li.innerHTML = `
              <a href="${product.url}">
                <img src="${product.images[0].src}" alt="${product.title}" width="100">
                <p>${product.title}</p>
                <p>${product.variants[0].price} {{ shop.currency }}</p>
              </a>
              <button onclick="removeFromWishlist('${product.id}')">Remove</button>
            `;
            wishlistContainer.appendChild(li);
          });
      });
    }
  });

  function removeFromWishlist(productId) {
    let wishlist = JSON.parse(localStorage.getItem("wishlist")) || [];
    wishlist = wishlist.filter(id => id !== productId);
    localStorage.setItem("wishlist", JSON.stringify(wishlist));
    location.reload();
  }
</script>
