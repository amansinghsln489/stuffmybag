<div class="container">
  <h1>Your Wishlist</h1>

  {% if customer %}
    <table class="table table-bordered">
      <thead>
        <tr>
          <td>Remove</td>
          <td>Image</td>
          <td>Product Name</td>
          <td>Price</td>
          <td>Add to Cart</td>
        </tr>
      </thead>
      <tbody>
        {% for tag in customer.tags %}
          {% if tag contains 'Wishlist-' %}
            {% assign product_id = tag | remove: 'Wishlist-' %}

            {% assign product = all_products[product_id] %}
            {% if product %}
              <tr>
                <td>
                  <a onclick="removeWishlist('{{ tag }}')">‚ùå</a>
                </td>
                <td>
                  <a href="{{ product.url }}">
                    <img src="{{ product.featured_image | product_img_url: 'small' }}" alt="{{ product.title }}">
                  </a>
                </td>
                <td>
                  <a href="{{ product.url }}">{{ product.title }}</a>
                </td>
                <td>{{ product.price | money }}</td>
                <td>
                  <form method="post" action="/cart/add">
                    <input type="hidden" name="id" value="{{ product.variants.first.id }}">
                    <button type="submit">Add to Cart</button>
                  </form>
                </td>
              </tr>
            {% endif %}
          {% endif %}
        {% endfor %}
      </tbody>
    </table>

    <form method="post" action="/contact" id="removeWishlistForm">
      <input type="hidden" name="form_type" value="customer">
      <input type="hidden" name="contact[email]" value="{{ customer.email }}">
      <input type="hidden" name="contact[tags]" id="wishlist-remove-value" value="">
    </form>

    <script>
      function removeWishlist(tagID) {
        document.getElementById('wishlist-remove-value').value = tagID;
        document.getElementById('removeWishlistForm').submit();
      }
    </script>

  {% else %}
    <p>You need to <a href="/account/login">login</a> to see your wishlist.</p>
  {% endif %}
</div>
