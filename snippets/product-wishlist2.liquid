{% if customer %}
  {% assign value = product.id %}
  {% capture productID %}{{ product.id }}{% endcapture %}
  {% for tag in customer.tags %}
    {% capture tagID %}{{ tag }}{% endcapture %}
    {% if tagID contains productID %}
      {% capture value %}x{{ tagID }}{% endcapture %}
    {% endif %}
    {% if value.size == 0 %}
      {% assign value = productID %}
    {% endif %}
  {% endfor %}

  {% unless value.size == 0 %}
    {% assign check = tag.size | minus: productID.size | modulo: 2 %}
    {% comment %}{% capture check %}{{ value.size | minus:productID.size | money_without_currency | times:100 | divided_by:2 }}{% endcapture %}{% endcomment %}
    {% assign check = check | split: '.' %}
    {% if check[1] contains '5' %}
      {% assign display = false -%}
    {%- else -%}
      {%- assign display = true %}
    {% endif %}
  {% endunless %}

  {% if display %}
    <button class="wishlist-button" data-product-id="{{ value }}">❤️ Add to Wishlist</button>

  {% else %}

  {% endif %}
{% else %}
  <button
    class="button btn-wishlist"
    type="button"
    data-toggle="tooltip"
    title="{{ 'products.product.add_to_wishlist' | t }}"
    data-original-title="{{ 'products.product.add_to_wishlist' | t }}"
    onclick="location.href='/account/login'"
  >
    <span>{{ 'products.product.add_to_wishlist' | t }}</span>
  </button>
{% endif %}
<script>
    <script>
    document.addEventListener("DOMContentLoaded", function () {
      loadWishlist();

      function toggleWishlist(button) {
        let productId = button.getAttribute("data-product-id");
        let wishlist = JSON.parse(localStorage.getItem("wishlist")) || [];

        if (wishlist.includes(productId)) {
          wishlist = wishlist.filter(id => id !== productId);
          button.innerHTML = "❤️ Add to Wishlist";
        } else {
          wishlist.push(productId);
          button.innerHTML = "✔ Added to Wishlist";
        }

        localStorage.setItem("wishlist", JSON.stringify(wishlist));
        updateWishlistCount();
      }

      function loadWishlist() {
        let wishlist = JSON.parse(localStorage.getItem("wishlist")) || [];
        document.querySelectorAll(".wishlist-button").forEach(button => {
          let productId = button.getAttribute("data-product-id");
          if (wishlist.includes(productId)) {
            button.innerHTML = "✔ Added to Wishlist";
          }
        });
        updateWishlistCount();
      }

      function updateWishlistCount() {
        let wishlist = JSON.parse(localStorage.getItem("wishlist")) || [];
        let countElement = document.getElementById("wishlist-count");
        if (countElement) {
          countElement.textContent = wishlist.length;
        }
      }
    });
  </script>
</script>
